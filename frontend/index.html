<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuro Chat</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

    <div class="chat-container">
        <aside class="sidebar">
            <button class="new-chat-btn">Neuro Chat</button>
            <div class="chat-history">
                <button id="toggle-archive-view-btn" class="history-new-chat-btn">Archived</button>
                <ul id="history-list">
                </ul>
            </div>
            <div id="options-container" class="options-container">
                <div id="options-panel" class="options-panel">
                    <div class="option-section">
                        <label for="api-key-input">API Key</label>
                        <div class="input-with-button">
                            <input type="password" id="api-key-input" placeholder="sk-">
                            <button id="verify-api-key-btn">Verify</button>
                        </div>
                    </div>
                    <div id="ai-model-container" class="option-section"></div>
                    <div class="option-section">
                        <label>Import Chats</label>
                        <div id="import-container">
                            <input type="file" id="json-file-input" accept=".json" hidden>
                            <button id="import-drop-area" class="import-button">Click or drag conversations.json</button>                            
                            <div id="import-progress-box" style="display: none;">
                                <div id="import-progress-fill"></div>
                                <span id="import-progress-percent">0%</span>
                            </div>
                        </div>
                    </div>
                    <div class="option-section">
                        <label>Upload Knowledge</label>
                        <div id="knowledge-upload-container">
                            <input type="file" id="knowledge-file-input" accept=".txt,.md" hidden multiple>
                            <button id="knowledge-upload-btn" class="import-button">Click or drag .txt files</button>
                        </div>
                    </div>
                </div>
                <button id="options-btn" class="options-btn">Options</button>
            </div>
        </aside>

        <main class="main-chat" id="main-chat-area">
            <header class="chat-header">
                <h2 id="chat-header-title"></h2>
                <div class="header-controls"> <!-- NEW WRAPPER for all controls -->
                    <div class="message-nav-buttons"> <!-- NEW container for nav buttons -->
                        <button id="nav-up-btn" class="nav-btn" aria-label="Scroll to previous message boundary" title="Previous message (Alt+↑)">
                            <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20" fill="currentColor"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg>
                        </button>
                        <button id="nav-down-btn" class="nav-btn" aria-label="Scroll to next message boundary" title="Next message (Alt+↓)">
                            <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"></path></svg>
                        </button>
                    </div>
                    <div class="kebab-wrapper">
                        <button class="kebab-menu-btn" title="More options">
                            <!-- SVG for kebab menu remains here -->
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="currentColor"><path d="M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z"/></svg>
                        </button>
                        <div id="chat-options-dropdown" class="dropdown-menu">
                            <a href="#" data-action="rename">Rename</a>
                            <a href="#" data-action="archive">Archive</a>
                            <a href="#" data-action="delete" class="delete-option">Delete</a>
                        </div>
                    </div>
                </div>
            </header>
            
            <div id="home-page-view">
                <button id="temp-chat-btn" title="Temporary Chat is OFF">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zM8 4h8v3.5l-4 4-4-4V4z"></path></svg>
                </button>
                <div class="home-title">NeuroChat</div>
                <div class="prompt-starters">
                    <div class="starter-card"><h3>Brainstorm names</h3><p>for a new brand of coffee</p></div>
                    <div class="starter-card"><h3>Write a Python script</h3><p>that organizes files in a directory</p></div>
                    <div class="starter-card"><h3>Explain quantum computing</h3><p>in simple, easy-to-understand terms</p></div>
                    <div class="starter-card"><h3>Create a travel itinerary</h3><p>for a 3-day trip to Tokyo</p></div>
                </div>
            </div>

            <div class="message-area" id="message-area"></div>

            <footer class="chat-input-area">
                <button id="sources-btn" class="ai-model-btn sources-btn" title="Select Knowledge Sources">
                    Sources <span id="sources-badge" class="badge">All</span>
                </button>
                <button id="current-model-btn" class="ai-model-btn">Model</button>
                <textarea id="message-input" placeholder="Type a Message..."></textarea>
                <button id="attach-btn" class="action-btn" title="Attach file">+</button>
                <button id="send-btn" class="action-btn" title="Send message">⇧</button>
            </footer>
        </main>
    </div>

    <div id="sources-modal-overlay" class="modal-overlay" style="display: none;">
        <div id="sources-modal" class="modal">
            <header class="modal-header">
                <h3>Select Knowledge Sources</h3>
                <button id="close-sources-modal-btn" class="close-modal-btn">&times;</button>
            </header>
            <div class="modal-content">
                <div class="modal-actions">
                    <input type="search" id="sources-search-input" placeholder="Search sources...">
                    <button id="select-all-sources-btn">Select All</button>
                    <button id="select-none-sources-btn">Select None</button>
                </div>
                <div id="sources-list-container" class="sources-list">
                    <h4>Chats</h4>
                    <ul id="sources-list-chats">
                    </ul>
                    <h4>Files</h4>
                    <ul id="sources-list-files">
                    </ul>
                </div>
            </div>
            <footer class="modal-footer">
                <button id="apply-sources-btn">Apply</button>
            </footer>
        </div>
    </div>

    <script type="module" src="/static/script.js"></script>
</body>
</html>